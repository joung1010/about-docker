## 이미지(Image) 다운로드

### 🐳 이미지 다운로드

### **[최신 버전(latest) 이미지 다운로드]**

```bash
*# docker pull 이미지명*
$ docker pull nginx *# docker pull nginx:latest와 동일하게 작동*
```

이미지를 다운로드할 때 **Docker Hub**이라는 곳에서 이미지를 다운받아요.

Github은 사람들이 올려놓은 다양한 코드들이 저장되어 있어서 clone, pull을 받아서 사용할 수 있죠. Docker Hub도 마찬가지로 사람들이 올려놓은 이미지들이 저장되어 있어서 pull을 통해 다운받아서 사용할 수 있어요.

**Docker Hub**은 Github처럼 **이미지를 저장 및 다운받을 수 있는 저장소 역할**을 하고 있어요.

### 🏪 Docker Hub 상세 이해

### **Docker Hub의 구조**

```
Docker Hub 계층 구조:
┌─────────────────────────────────────────────────┐
│                Docker Hub                       │
│               (hub.docker.com)                  │
│                                                │
│  ┌─────────────────────────────────────────────┐│
│  │            Official Images                  ││
│  │  ┌─────────────────────────────────────────┐││
│  │  │ library/nginx    (공식 nginx)           │││
│  │  │ library/mysql    (공식 mysql)           │││
│  │  │ library/python   (공식 python)          │││
│  │  │ library/node     (공식 node.js)         │││
│  │  └─────────────────────────────────────────┘││
│  │                                            ││
│  │            User Images                     ││
│  │  ┌─────────────────────────────────────────┐││
│  │  │ username/my-app                         │││
│  │  │ company/backend-service                 │││
│  │  │ john/custom-nginx                       │││
│  │  └─────────────────────────────────────────┘││
│  │                                            ││
│  │         Organization Images                ││
│  │  ┌─────────────────────────────────────────┐││
│  │  │ bitnami/nginx                           │││
│  │  │ alpine/git                              │││
│  │  │ microsoft/dotnet                        │││
│  │  └─────────────────────────────────────────┘││
│  └─────────────────────────────────────────────┘│
└─────────────────────────────────────────────────┘
```

### **이미지 주소 체계**

```
완전한 이미지 주소 형태:
[레지스트리주소]/[네임스페이스]/[이미지명]:[태그]

예시들:
nginx                    → docker.io/library/nginx:latest
nginx:1.21              → docker.io/library/nginx:1.21
mysql:8.0               → docker.io/library/mysql:8.0
username/myapp          → docker.io/username/myapp:latest
username/myapp:v1.0     → docker.io/username/myapp:v1.0

다른 레지스트리:
gcr.io/project/image:tag               *# Google Container Registry*
amazon-ecr.amazonaws.com/image:tag     *# AWS ECR*
registry.gitlab.com/project/image:tag  *# GitLab Registry*
```

### **Docker Hub vs Github 비교**

```
공통점:
┌─────────────────┬─────────────────────────────────┐
│    Github       │         Docker Hub              │
├─────────────────┼─────────────────────────────────┤
│ 코드 저장소      │ 이미지 저장소                    │
│ git clone       │ docker pull                     │
│ 버전 관리 (tag) │ 이미지 태그                      │
│ 공개/비공개     │ 공개/비공개                      │
│ README 문서     │ 이미지 설명                      │
│ Star/Fork       │ Stars/Pulls                     │
└─────────────────┴─────────────────────────────────┘

차이점:
Github: 소스코드, 텍스트 파일
Docker Hub: 실행 가능한 바이너리 이미지
```

### 🏷️ 특정 버전 이미지 다운로드

### **[특정 버전 이미지 다운로드]**

```bash
*# docker pull 이미지명:태그명*
$ docker pull nginx:stable-perl
```

**특정 버전을 나타내는 이름**을 `태그명`이라고 해요. `태그명`은 Docker Hub에서 확인할 수 있어요.

### **태그(Tag) 시스템 상세**

```bash
nginx 이미지의 다양한 태그들:

버전 기반 태그:
nginx:1.25          *# 특정 메이저.마이너 버전*
nginx:1.25.3        *# 정확한 패치 버전*
nginx:1.25-alpine   *# Alpine Linux 기반 경량 버전*

OS 기반 태그:
nginx:alpine        *# Alpine Linux (5-10MB)*
nginx:debian        *# Debian 기반 (기본값)*
nginx:ubuntu        *# Ubuntu 기반*

기능 기반 태그:
nginx:stable        *# 안정 버전*
nginx:mainline      *# 최신 기능 포함 버전*
nginx:stable-perl   *# Perl 모듈 포함*
nginx:stable-alpine-perl  *# Alpine + Perl*

아키텍처 기반 태그:
nginx:latest-amd64  *# x86_64 아키텍처*
nginx:latest-arm64  *# ARM64 아키텍처 (M1 Mac 등)*
```

### **태그 확인 방법**

```bash
Docker Hub에서 태그 확인:
1. https://hub.docker.com/_/nginx/tags 접속
2. 사용 가능한 모든 태그 목록 확인
3. 각 태그별 용량과 OS 정보 확인

CLI에서 태그 확인:
$ docker search nginx
$ docker image history nginx:latest  *# 이미지 레이어 히스토리*

특정 태그 정보 확인:
$ docker image inspect nginx:alpine
```

### 🤔 태그가 없으면 어떤 걸 다운로드받을까?

Docker에서는 특정 태그가 존재하지 않는 경우 **가장 최신의 latest라는 태그가 자동으로 붙어서 다운로드받아져요**.

### **latest 태그의 동작 원리**

```
태그 생략 시 동작:
$ docker pull nginx
           ↓ 자동 변환
$ docker pull nginx:latest

내부 처리 과정:
1. 사용자가 docker pull nginx 실행
2. Docker가 태그 확인 → 태그 없음 감지
3. 자동으로 ":latest" 붙임
4. docker.io/library/nginx:latest로 요청
5. Docker Hub에서 latest 태그 이미지 다운로드
```

### **latest 태그 주의사항**

```
❌ 흔한 오해:
"latest = 가장 최신 버전"

✅ 실제 의미:
"latest = 기본 태그일 뿐, 반드시 최신은 아님"

예시:
nginx:latest     → 1.25.3 (안정 버전)
nginx:mainline   → 1.26.0 (실제 최신 버전)

mysql:latest     → 8.0.35 (안정 버전)
mysql:8.2        → 8.2.0 (실제 최신 버전)

프로덕션 환경에서는 정확한 버전 명시 권장:
❌ FROM nginx              *# latest 태그 (예측 불가능)*
✅ FROM nginx:1.25.3       *# 정확한 버전 (예측 가능)*
```

### 📦 이미지 다운로드 상세 과정

### **실제 다운로드 과정 분석**

```bash
$ docker pull nginx:alpine

실행 결과:
alpine: Pulling from library/nginx
4abcf2066143: Pull complete    ← Alpine base layer
4db8e8b3e654: Pull complete    ← System libraries  
67b77bbb7ad8: Pull complete    ← Nginx binary
e61e19e30db5: Pull complete    ← Config files
e6e3ba1e8dd4: Pull complete    ← Default pages
Digest: sha256:2d194184b067db3598771b4cf326cfe6ad5051937ba4132f8077d9d0aaf3a3fa
Status: Downloaded newer image for nginx:alpine
docker.io/library/nginx:alpine

각 단계 설명:
1. Docker Hub에서 매니페스트 조회
2. 필요한 레이어 목록 확인
3. 로컬에 없는 레이어만 다운로드
4. 각 레이어를 압축 해제하여 저장
5. 이미지 메타데이터 저장
```

### **레이어 캐싱 최적화**

```
레이어 재사용 예시:
이미 nginx:latest가 있는 상태에서
$ docker pull nginx:alpine

4abcf2066143: Already exists   ← 동일한 Alpine base
67b77bbb7ad8: Pull complete    ← nginx:alpine만의 차이점
e61e19e30db5: Pull complete    ← 설정 파일 차이

장점:
- 네트워크 트래픽 절약
- 다운로드 시간 단축  
- 디스크 공간 효율성
```

### 🔍 이미지 정보 확인

### **다운로드한 이미지 확인하기**

```bash
모든 이미지 보기:
$ docker image ls
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
nginx        latest    605c77e624dd   2 weeks ago    141MB
nginx        alpine    4f380adfc10f   2 weeks ago    38MB
nginx        stable    605c77e624dd   2 weeks ago    141MB

특정 이미지만 보기:
$ docker image ls nginx
$ docker image ls nginx:alpine

이미지 크기별 정렬:
$ docker image ls --format "table {{.Repository}}\t{{.Tag}}\t{{.Size}}" | sort -k3 -h
```

### **이미지 상세 정보**

```bash
이미지 레이어 구조 확인:
$ docker image history nginx:alpine

IMAGE          CREATED        CREATED BY                                      SIZE
4f380adfc10f   2 weeks ago    /bin/sh -c *#(nop)  CMD ["nginx" "-g" "daemon…   0B*
<missing>      2 weeks ago    /bin/sh -c *#(nop)  STOPSIGNAL SIGQUIT           0B*
<missing>      2 weeks ago    /bin/sh -c *#(nop)  EXPOSE 80                    0B*
<missing>      2 weeks ago    /bin/sh -c *#(nop)  ENTRYPOINT ["/docker-entr…   0B*
<missing>      2 weeks ago    /bin/sh -c *#(nop) COPY file:9e3b2b63db9f8fc7…   4.61kB*
<missing>      2 weeks ago    /bin/sh -c *#(nop) COPY file:57846632accc8975…   3.02kB*
<missing>      2 weeks ago    /bin/sh -c *#(nop) COPY file:3b1b9915b7dd898a…   298B*
<missing>      2 weeks ago    /bin/sh -c *#(nop) COPY file:caec368f5a54f70a…   2.12kB*
<missing>      2 weeks ago    /bin/sh -c *#(nop) COPY file:01e75c6dd0ce317d…   1.62kB*
<missing>      2 weeks ago    /bin/sh -c set -x     && addgroup -g 101 -S …   17.4MB
<missing>      3 weeks ago    /bin/sh -c *#(nop) ADD file:756183bba9c7f4593…   7.38MB*

각 레이어의 크기와 생성 명령어 확인 가능
```

### 🌐 다양한 이미지 저장소

### **공식 vs 비공식 이미지**

```
공식 이미지 (Verified Publisher):
nginx          *# Docker 공식 인증*
mysql          *# MySQL 팀 공식*
python         *# Python 팀 공식*
node           *# Node.js 팀 공식*

특징:
✅ 보안 스캔 완료
✅ 정기적 업데이트
✅ 문서 완비
✅ 베스트 프랙티스 적용

비공식 이미지 (Community):
bitnami/nginx  *# Bitnami에서 제작*
jwilder/nginx-proxy
custom/my-app

주의사항:
⚠️ 보안 검증 필요
⚠️ 업데이트 빈도 확인
⚠️ 다운로드 수와 평점 확인
```

### **이미지 선택 가이드**

```
이미지 선택 기준:

1. 공식 이미지 우선:
✅ nginx (공식)
❌ someone/nginx (비공식)

2. 크기 고려:
nginx:alpine (38MB)   ← 경량화 우선
nginx:latest (141MB)  ← 기능 완성도 우선

3. 보안 스캔:
$ docker scan nginx:alpine  *# 취약점 스캔*

4. 다운로드 통계 확인:
- Docker Hub에서 Downloads 수 확인
- Stars 수 확인
- Last Updated 날짜 확인

5. 문서 품질:
- README 완성도
- 사용 예시 제공
- 환경 변수 설명
```

이렇게 이미지 다운로드의 모든 측면을 이해하면, 적절한 이미지를 선택하고 효율적으로 관리할 수 있어요!

[nginx - Official Image | Docker Hub](https://hub.docker.com/_/nginx)