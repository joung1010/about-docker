## 컨테이너 내부에 접속하기

### 🔄 컨테이너 개념 다시 짚어보기

위 설명에서 **컨테이너**는 **미니 컴퓨터**라고 표현했죠. 즉, 호스트 컴퓨터 안에 다른 새로운 컴퓨터가 여러 개 있는 것과 같아요. 따라서 각각의 컨테이너는 자기만의 컴퓨터 공간(OS, 저장 공간, 프로그램 등)을 가지고 있어요.

```
Host Computer (실제 컴퓨터)
┌─────────────────────────────────────────────────┐
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐│
│  │Container 1  │  │Container 2  │  │Container 3  ││
│  │(미니컴퓨터1) │  │(미니컴퓨터2) │  │(미니컴퓨터3) ││
│  │             │  │             │  │             ││
│  │ - Debian OS │  │ - Alpine OS │  │ - Ubuntu OS ││
│  │ - Nginx     │  │ - MySQL     │  │ - Python    ││
│  │ - 독립 파일 │  │ - 독립 파일 │  │ - 독립 파일 ││
│  │   시스템    │  │   시스템    │  │   시스템    ││
│  └─────────────┘  └─────────────┘  └─────────────┘│
└─────────────────────────────────────────────────┘
```

실제 컴퓨터에서 다른 컴퓨터로 SSH 접속하듯이, 호스트에서 컨테이너로 "접속"할 수 있어요.

### ✅ 실행 중인 컨테이너 내부에 접속하기

```bash
*# docker exec -it 컨테이너명[또는 컨테이너 ID] bash*

$ docker run -d nginx
$ docker exec -it [Nginx가 실행되고 있는 컨테이너 ID] bash
$ ls *# 컨테이너 내부 파일 조회*
$ cd /etc/nginx 
$ cat nginx.conf
```

### **docker exec 명령어 상세 분석**

```bash
docker exec [OPTIONS] CONTAINER COMMAND [ARG...]

구성 요소:
- docker exec: 실행 중인 컨테이너에서 새 명령어 실행
- -it: 인터랙티브 터미널 모드
- 컨테이너명/ID: 접속할 대상 컨테이너
- bash: 실행할 명령어 (쉘)
```

### **it 옵션 상세 분석**

- *`it`*옵션을 사용해야 명령어를 입력하고 결과를 확인할 수 있어요. **`it`*옵션을 적지 않으면 명령어를 1번만 실행시키고 종료되어 버려요. 즉, **`it`** 옵션을 적어야 계속해서 명령어를 입력할 수 있어요.

```bash
it 옵션 분해:
-i (--interactive): 표준입력(stdin) 열어두기
-t (--tty): 가상 터미널(TTY) 할당
-i 옵션만 사용:
$ docker exec -i nginx_container bash
echo "hello"
hello
*# 입력은 가능하지만 프롬프트가 보이지 않음*
-t 옵션만 사용:
$ docker exec -t nginx_container bash
root@abc123def456:/*# # 프롬프트는 보이지만 입력이 제대로 처리되지 않음*
-it 옵션 함께 사용:
$ docker exec -it nginx_container bash
root@abc123def456:/*# echo "hello"*
hello
root@abc123def456:/*# # 정상적인 대화형 셸 환경*
```

### **실제 접속 과정**

```bash
컨테이너 실행:
$ docker run -d --name web nginx
abc123def456

컨테이너 접속:
$ docker exec -it web bash
root@abc123def456:/*#* 

프롬프트 분석:
root: 사용자명 (컨테이너 내부에서는 기본적으로 root)
@: 구분자
abc123def456: 호스트명 (컨테이너 ID의 앞 12자리)
:/: 현재 디렉토리 (루트 디렉토리)
*# : root 사용자 프롬프트 (일반 사용자는 $)*
```

### **컨테이너 내부 탐색**

```bash
컨테이너 내부 파일 시스템 탐색:
root@abc123def456:/*# ls*
bin   dev  home  lib32  libx32  mnt  proc  run   srv  tmp  var
boot  etc  lib   lib64  media   opt  root  sbin  sys  usr

nginx 설정 파일 확인:
root@abc123def456:/*# cd /etc/nginx*
root@abc123def456:/etc/nginx*# ls*
conf.d          mime.types  nginx.conf
fastcgi_params  modules     scgi_params
koi-utf         koi-win     uwsgi_params

root@abc123def456:/etc/nginx*# cat nginx.conf*
user  nginx;
worker_processes  auto;

error_log  /var/log/nginx/error.log notice;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;
    ...
}
```

### 🚪 컨테이너에서 나오기

컨테이너 내부에서 나오려면 **`Ctrl + D`** 또는 **`exit`**을 입력하면 돼요.

bash

```bash
컨테이너 내부에서:
root@abc123def456:/etc/nginx*# exit*
exit

*# 또는 Ctrl + D*

다시 호스트 터미널로:
jeonghwanpark@Jeonghwanui-MacBookAir  ~  

주의사항:
- exit나 Ctrl+D는 exec 세션만 종료
- 원래 컨테이너는 계속 실행 중
- 메인 프로세스(nginx)는 영향받지 않음
```

### 🖥️ bash: 쉘(Shell)의 일종

**bash**는 리눅스/유닉스 시스템에서 사용하는 명령어 해석기(Shell)예요.

```bash
다양한 쉘 종류:
bash: Bourne Again Shell (가장 일반적)
sh: Bourne Shell (기본 쉘)
zsh: Z Shell (macOS 기본)
fish: Friendly Interactive Shell
ash: Almquist Shell (Alpine Linux 기본)

컨테이너별 쉘 확인:
*# bash 사용 (Debian/Ubuntu 기반)*
$ docker exec -it ubuntu_container bash

*# sh 사용 (Alpine 기반)*  
$ docker exec -it alpine_container sh

*# 사용 가능한 쉘 확인*
$ docker exec -it container_name cat /etc/shells
/bin/ash
/bin/sh
/bin/bash
```

### 🔍 컨테이너 OS 확인

### **`cat /etc/*-release`**

```bash
root@abc123def456:/etc/nginx*# cat /etc/*-release*
PRETTY_NAME="Debian GNU/Linux 12 (bookworm)"
NAME="Debian GNU/Linux"
VERSION_ID="12"
VERSION="12 (bookworm)"
VERSION_CODENAME=bookworm
ID=debian
HOME_URL="https://www.debian.org/"
SUPPORT_URL="https://www.debian.org/support"
BUG_REPORT_URL="https://bugs.debian.org/"
```

### **다양한 OS 확인 방법**

```bash
OS 정보 확인 방법들:
*# 배포판 정보*
$ cat /etc/os-release
$ cat /etc/*-release

*# 커널 정보*
$ uname -a
Linux abc123def456 5.15.49-linuxkit *#1 SMP Tue Sep 13 07:51:46 UTC 2022 x86_64 GNU/Linux# 호스트명*
$ hostname
abc123def456

*# CPU 정보*
$ cat /proc/cpuinfo

*# 메모리 정보*
$ cat /proc/meminfo
$ free -h

*# 디스크 정보*
$ df -h
Filesystem      Size  Used Avail Use% Mounted on
overlay         59G   15G   42G  27% /
tmpfs           64M     0   64M   0% /dev
```

### 📦 컨테이너 내부에 패키지 설치하기

```bash
apt-get update
apt-get install vim
```

### **다른 OS별 패키지 설치**

```bash
Alpine Linux:
$ apk update
$ apk add vim

CentOS/RHEL:
$ yum update
$ yum install vim

Ubuntu:
$ apt update
$ apt install vim

패키지 설치 후 확인:
root@abc123def456:/*# which vim*
/usr/bin/vim

root@abc123def456:/*# vim --version*
VIM - Vi IMproved 9.0
```