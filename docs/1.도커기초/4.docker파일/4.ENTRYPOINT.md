## ENTRYPOINT : ì»¨í…Œì´ë„ˆê°€ ì‹œì‘í•  ë•Œ ì‹¤í–‰ë˜ëŠ” ëª…ë ¹ì–´

### ì˜ë¯¸

`ENTRYPOINT`ëŠ” ì»¨í…Œì´ë„ˆê°€ ìƒì„±ë˜ê³  ìµœì´ˆë¡œ ì‹¤í–‰í•  ë•Œ ìˆ˜í–‰ë˜ëŠ” ëª…ë ¹ì–´ë¥¼ ëœ»í•´ìš”. ì‰½ê²Œ ì„¤ëª…í•˜ìë©´ `ENTRYPOINT`ì—ëŠ” ë¯¸ë‹ˆ ì»´í“¨í„°ì˜ ì „ì›ì„ í‚¤ê³ ë‚˜ì„œ ì‹¤í–‰ì‹œí‚¤ê³  ì‹¶ì€ ëª…ë ¹ì–´ë¥¼ ì ìœ¼ë©´ ë¼ìš”.

ëª…ë ¹ì–´ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë¦¬ëˆ…ìŠ¤ ëª…ë ¹ì–´ë¥¼ ì ìœ¼ë©´ ë¼ìš”.

### ì‚¬ìš©ë²•

```bash
*# ë¬¸ë²•*
ENTRYPOINT [ëª…ë ¹ë¬¸...]

*# ì˜ˆì‹œ*
ENTRYPOINT ["node", "dist/main.js"]
```

### **ENTRYPOINT í˜•íƒœ**

```bash
ENTRYPOINTì˜ ë‘ ê°€ì§€ í˜•íƒœ:

1. Exec í˜•íƒœ (ê¶Œì¥):
ENTRYPOINT ["executable", "param1", "param2"]
ENTRYPOINT ["node", "app.js"]
ENTRYPOINT ["/bin/bash", "-c", "echo hello"]

2. Shell í˜•íƒœ:
ENTRYPOINT command param1 param2
ENTRYPOINT node app.js
ENTRYPOINT echo hello

ì°¨ì´ì :
Exec í˜•íƒœ: í”„ë¡œì„¸ìŠ¤ê°€ PID 1ë¡œ ì§ì ‘ ì‹¤í–‰ë¨
Shell í˜•íƒœ: /bin/sh -cë¥¼ í†µí•´ ì‹¤í–‰ë¨ (PID 1ì´ sh)
```

## ì˜ˆì œ

**Dockerfile**

```bash
FROM ubuntu

ENTRYPOINT ["/bin/bash", "-c", "echo hello"]
```

```bash
$ docker build -t my-server .
$ docker run -d my-server
$ docker ps -a
$ docker logs [Container ID]
```

### **ì‹¤í–‰ ê²°ê³¼ ë¶„ì„**

```bash
ë¹Œë“œ ë° ì‹¤í–‰:
$ docker build -t my-server .
$ docker run -d my-server
abc123def456

ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸:
$ docker ps -a
CONTAINER ID   IMAGE      COMMAND                  CREATED         STATUS                     PORTS   NAMES
abc123def456   my-server  "/bin/bash -c 'echo â€¦"   1 minute ago    Exited (0) 1 minute ago            amazing_name

ë¡œê·¸ í™•ì¸:
$ docker logs abc123def456
hello

ë™ì‘ ê³¼ì •:
1. ì»¨í…Œì´ë„ˆ ì‹œì‘
2. ENTRYPOINT ëª…ë ¹ì–´ ì‹¤í–‰: echo hello
3. "hello" ì¶œë ¥ í›„ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
4. ë©”ì¸ í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œë˜ì—ˆìœ¼ë¯€ë¡œ ì»¨í…Œì´ë„ˆë„ ì¢…ë£Œ (Exited)
```

### ğŸ”„ ENTRYPOINT vs CMD

### **ì£¼ìš” ì°¨ì´ì **

```bash
ENTRYPOINT vs CMD:

ENTRYPOINT:
- í•­ìƒ ì‹¤í–‰ë˜ëŠ” ê³ ì • ëª…ë ¹ì–´
- docker run ì‹œ ë®ì–´ì“¸ ìˆ˜ ì—†ìŒ
- ì»¨í…Œì´ë„ˆì˜ ê¸°ë³¸ ì‹¤í–‰ íŒŒì¼ ì—­í• 

CMD:
- ê¸°ë³¸ ëª…ë ¹ì–´ ë˜ëŠ” ë§¤ê°œë³€ìˆ˜
- docker run ì‹œ ì‰½ê²Œ ë®ì–´ì“¸ ìˆ˜ ìˆìŒ
- ENTRYPOINTê°€ ì—†ìœ¼ë©´ ë©”ì¸ ëª…ë ¹ì–´ ì—­í• 

ì˜ˆì‹œ 1 - ENTRYPOINTë§Œ ì‚¬ìš©:
FROM ubuntu
ENTRYPOINT ["echo", "Hello"]

$ docker run my-image
Hello
$ docker run my-image World    *# "World"ê°€ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ë¨*
Hello World

ì˜ˆì‹œ 2 - CMDë§Œ ì‚¬ìš©:
FROM ubuntu
CMD ["echo", "Hello"]

$ docker run my-image
Hello
$ docker run my-image echo "Goodbye"    *# CMDê°€ ì™„ì „íˆ ëŒ€ì²´ë¨*
Goodbye

ì˜ˆì‹œ 3 - ENTRYPOINT + CMD ì¡°í•©:
FROM ubuntu  
ENTRYPOINT ["echo"]
CMD ["Hello"]

$ docker run my-image
Hello
$ docker run my-image "World"    *# CMDê°€ "World"ë¡œ ëŒ€ì²´ë¨*
World
```

### ğŸ’» ë‹¤ì–‘í•œ ENTRYPOINT í™œìš© ì˜ˆì‹œ

### **ì›¹ì„œë²„ ì‹¤í–‰**

```bash
Node.js ì„œë²„:
FROM node:18
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
ENTRYPOINT ["node", "server.js"]

Python Flask ì„œë²„:
FROM python:3.11
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
ENTRYPOINT ["python", "app.py"]

Java Spring Boot:
FROM openjdk:17-jdk
WORKDIR /app
COPY target/app.jar app.jar
ENTRYPOINT ["java", "-jar", "app.jar"]
```

### **ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„**

```bash
MySQLê³¼ ìœ ì‚¬í•œ íŒ¨í„´:
FROM mysql:8.0
COPY custom-config.cnf /etc/mysql/conf.d/
ENTRYPOINT ["docker-entrypoint.sh", "mysqld"]
```

### **ë³µì¡í•œ ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸**

```bash
FROM ubuntu
COPY startup.sh /startup.sh
RUN chmod +x /startup.sh
ENTRYPOINT ["/startup.sh"]

startup.sh:
*#!/bin/bash*
echo "Starting initialization..."
*# í™˜ê²½ ë³€ìˆ˜ í™•ì¸*
if [ -z "$DATABASE_URL" ]; then
  echo "DATABASE_URL not set"
  exit 1
fi

*# ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜*
./migrate.sh

*# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘*
exec "$@"   # CMD ë§¤ê°œë³€ìˆ˜ë“¤ì„ ì‹¤í–‰
```

### ğŸ› ï¸ ENTRYPOINT ì‹¤í–‰ í˜•íƒœ ìƒì„¸

### **Exec í˜•íƒœ vs Shell í˜•íƒœ**

```bash
Exec í˜•íƒœì˜ ì¥ì :
FROM ubuntu
ENTRYPOINT ["echo", "Hello World"]

í”„ë¡œì„¸ìŠ¤ íŠ¸ë¦¬:
PID 1: echo Hello World
- ì§ì ‘ ì‹¤í–‰ë¨
- ì‹ í˜¸ ì²˜ë¦¬ ì •ìƒ ì‘ë™
- ë” ë¹ ë¥¸ ì‹œì‘

Shell í˜•íƒœì˜ íŠ¹ì„±:
FROM ubuntu  
ENTRYPOINT echo "Hello World"

í”„ë¡œì„¸ìŠ¤ íŠ¸ë¦¬:
PID 1: /bin/sh -c "echo Hello World"
  â””â”€ PID 2: echo Hello World
- ì‰˜ì„ í†µí•´ ì‹¤í–‰ë¨
- í™˜ê²½ ë³€ìˆ˜ ì¹˜í™˜ ê°€ëŠ¥
- ì‹ í˜¸ ì²˜ë¦¬ ë¬¸ì œ ë°œìƒ ê°€ëŠ¥
```

### **í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©**

```bash
Shell í˜•íƒœì—ì„œ í™˜ê²½ ë³€ìˆ˜:
FROM ubuntu
ENV NAME=Docker
ENTRYPOINT echo "Hello $NAME"
*# ê²°ê³¼: Hello Docker*

Exec í˜•íƒœì—ì„œ í™˜ê²½ ë³€ìˆ˜:
FROM ubuntu
ENV NAME=Docker
ENTRYPOINT ["/bin/bash", "-c", "echo Hello $NAME"]
*# ê²°ê³¼: Hello Docker*

ë˜ëŠ”:
FROM ubuntu
ENV NAME=Docker
ENTRYPOINT ["sh", "-c", "echo Hello ${NAME}"]
```

### ğŸ” ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### **ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬**

```bash
FROM node:18-alpine
WORKDIR /app

*# ì˜ì¡´ì„± ì„¤ì¹˜*
COPY package*.json ./
RUN npm ci --only=production

*# ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ë³µì‚¬*
COPY . .

*# í¬íŠ¸ ë…¸ì¶œ*
EXPOSE 3000

*# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰*
ENTRYPOINT ["node", "index.js"]
```

### **ê°œë°œ í™˜ê²½ê³¼ í”„ë¡œë•ì…˜ í™˜ê²½**

```bash
ê°œë°œìš© Dockerfile:
FROM node:18
WORKDIR /app
COPY package*.json ./
RUN npm install  # devDependenciesë„ í¬í•¨
COPY . .
ENTRYPOINT ["npm", "run", "dev"]  # ê°œë°œ ì„œë²„ ì‹¤í–‰

í”„ë¡œë•ì…˜ìš© Dockerfile:
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production  # í”„ë¡œë•ì…˜ ì˜ì¡´ì„±ë§Œ
COPY . .
ENTRYPOINT ["npm", "start"]   # í”„ë¡œë•ì…˜ ì„œë²„ ì‹¤í–‰
```

### **í—¬ìŠ¤ì²´í¬ì™€ í•¨ê»˜**

```bash
FROM nginx:alpine
COPY nginx.conf /etc/nginx/nginx.conf
COPY --from=builder /app/dist /usr/share/nginx/html

HEALTHCHECK --interval=30s --timeout=3s \
  CMD curl -f http://localhost/ || exit 1

ENTRYPOINT ["nginx", "-g", "daemon off;"]
```

### ğŸš¨ ì£¼ì˜ì‚¬í•­ê³¼ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### **PID 1 ë¬¸ì œ**

```bash
ë¬¸ì œ: ì‹ í˜¸ ì²˜ë¦¬
ì˜ëª»ëœ ë°©ë²•:
ENTRYPOINT ["sh", "-c", "my-app"]

ë¬¸ì œì : shê°€ PID 1ì´ ë˜ì–´ SIGTERM ë“±ì˜ ì‹ í˜¸ë¥¼ my-appì— ì „ë‹¬í•˜ì§€ ì•ŠìŒ

ì˜¬ë°”ë¥¸ ë°©ë²•:
ENTRYPOINT ["my-app"]
ë˜ëŠ”:
ENTRYPOINT ["sh", "-c", "exec my-app"]  *# execë¡œ í”„ë¡œì„¸ìŠ¤ êµì²´*
```

### **ê¶Œí•œ ë¬¸ì œ**

```bash
ê¶Œí•œ ë¬¸ì œ í•´ê²°:
FROM ubuntu
RUN groupadd -r appgroup && useradd -r -g appgroup appuser
COPY --chown=appuser:appgroup app.py /app/app.py
USER appuser
ENTRYPOINT ["python", "/app/app.py"]
```

### **ë””ë²„ê¹…ì„ ìœ„í•œ ì˜¤ë²„ë¼ì´ë“œ**

```bash
ENTRYPOINT ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ë””ë²„ê¹…:
$ docker run -it --entrypoint /bin/bash my-image

ë˜ëŠ” ì„ì‹œë¡œ ë‹¤ë¥¸ ëª…ë ¹ì–´ ì‹¤í–‰:
$ docker run -it --entrypoint="" my-image /bin/bash
```

### ğŸ“‹ ENTRYPOINT ëª¨ë²” ì‚¬ë¡€

### **1. ëª…ë ¹ì–´ í˜•íƒœ ì„ íƒ**

```bash
ê¶Œì¥ì‚¬í•­:
âœ… Exec í˜•íƒœ ì‚¬ìš©: ENTRYPOINT ["cmd", "arg1"]
âŒ Shell í˜•íƒœ ì§€ì–‘: ENTRYPOINT cmd arg1

ì˜ˆì™¸: í™˜ê²½ ë³€ìˆ˜ ì¹˜í™˜ì´ë‚˜ ì‰˜ ê¸°ëŠ¥ì´ í•„ìš”í•œ ê²½ìš°
ENTRYPOINT ["/bin/bash", "-c", "echo $ENV_VAR && exec my-app"]
```

### **2. ìœ ì—°í•œ ì„¤ê³„**

```bash
ë² ì´ìŠ¤ ëª…ë ¹ì–´ + ë§¤ê°œë³€ìˆ˜ íŒ¨í„´:
FROM python:3.11
WORKDIR /app
COPY . .
ENTRYPOINT ["python", "manage.py"]
CMD ["runserver", "0.0.0.0:8000"]

ì‚¬ìš©ë²•:
$ docker run my-django                    # python manage.py runserver 0.0.0.0:8000
$ docker run my-django migrate           # python manage.py migrate
$ docker run my-django shell             # python manage.py shell
```

### **3. ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸ íŒ¨í„´**

```bash
FROM ubuntu
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh
ENTRYPOINT ["/entrypoint.sh"]
CMD ["my-app"]

entrypoint.sh:
*#!/bin/bash*
set -e

*# ì´ˆê¸°í™” ì‘ì—…*
echo "Initializing..."
setup_database
configure_app

*# ë©”ì¸ í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ (CMD ë§¤ê°œë³€ìˆ˜ë“¤)*
exec "$@"
```